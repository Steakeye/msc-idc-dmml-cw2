---
title: "q4"
output: html_document
bibliography: bibliography.ris
---


```{r setup-t4, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r deps-t4, echo=FALSE, include=FALSE, message=FALSE}
if(!require(caret)) install.packages("caret", repos = mirrorUrl)
if(!require(klaR)) install.packages("klaR", repos = mirrorUrl)
if(!require(rpart.plot)) install.packages("rpart.plot", repos = mirrorUrl)

#
library("caret")
library("klaR")
library("rpart.plot")
```

<section>

#Task 4: Build Train and Test a Naïve Bayes type Classifier

##Premise

>You need to construct, train and test Naïve Bayes type classifier in R. Train and test your Naïve Byes classifier using the training and test sets generated based on the methods tried as part of the 2nd Task.

<!--
• Building of Naïve Bayes type classifier in R 4
• Training of Naïve Bayes type classifier in R 5
• Testing of Naïve Bayes type classifier in R 6
-->

Naive Bayes is a relatively quick and simple probabilistic classifier that is often used as a benchmark for other forms of classification; if another technique is in some way superior, be that in terms of speed or accuracy, then it's worth sharing. If a proposed algorithm cannot improve on Naive Bayes, then it needs further work, or consigned to only be of use to a very niche problem or set aside completely.

##Naive Bayes training

###Naive Bayes formula and simpler classification

Precedent was set in the previous task to use a specific formula to target key predictors _(weight.shell, height, diameter)_ and classify data instances based on a factor representing simplified age grouping; that precedent applies to the modelling in this chapter and following sections.

###Naive Bayes with holdout

```{r nb-h_a}
nb.h_a <- NaiveBayes(dt.formula, data=holdout_age_groups.training)
```

```{r nb-h_a-summary}
plot(nb.h_a)
```

####Naive Bayes with holdout, training results

```{r nb-h_a_test_results}
nb.h_a_test <- predict(nb.h_a, holdout_age_groups.testing)
nb.h_a_test_prob <- predict(nb.h_a, holdout_age_groups.testing, type = "prob")
# summarize results
nb.h_a_test_cm <- confusionMatrix(nb.h_a_test$class, holdout_age_groups.testing$age_group)
nb.h_a_test_cm
```


###Naive Bayes with Repeated K-folds Cross-validation

```{r nb-r5kf8_a}
nb.r5kf8_a <- train(dt.formula, data=abalone_data_cleansed_age_groups, trControl = cv.train_control_8_5, method="nb")
```

```{r nb-r5kf8_a-summary}
plot(nb.r5kf8_a)
```

####Naive Bayes with Repeated K-folds, training results

```{r nb-r5kf8_a_test_results}
nb.r5kf8_a_test <- predict(nb.r5kf8_a, holdout_age_groups.testing)
nb.r5kf8_a_test_prob <- predict(nb.r5kf8_a, holdout_age_groups.testing, type = "prob")
# summarize results
nb.r5kf8_a_test_cm <- confusionMatrix(nb.r5kf8_a_test, holdout_age_groups.testing$age_group)
nb.r5kf8_a_test_cm
```

###Naive Bayes with Leave-one-out Cross-validation

```{r nb-loo_a}
nb.loo_a <- train(dt.formula, data=abalone_data_cleansed_age_groups, trControl = loocv.train_control, method="nb")
```

```{r nb-loo_a-summary}
plot(nb.loo_a)
```

####Naive Bayes with Leave-one-out, training results

```{r nb-loo_a_test_results}
nb.loo_a_test <- predict(nb.loo_a, holdout_age_groups.testing)
# summarize results
nb.loo_a_test_cm <- confusionMatrix(nb.loo_a_test, holdout_age_groups.testing$age_group)
nb.loo_a_test_cm
```



###Accuracy comparison of NB models


```{r}
nb.h_a_test_cm$overall[1]
nb.r5kf8_a_test_cm$overall[1]
nb.loo_a_test_cm$overall[1]
```


</section>
